# -*- coding: utf-8 -*-
"""Heart Disease Prediction

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ZUjyCZSNHqzloZioBgA3LOMBb1DbR-hl

Importing Libraries
"""

import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

"""Importing Dataset"""

from google.colab import drive
drive.mount('/content/drive')

df=pd.read_csv('/content/drive/MyDrive/datapreprocessing_PranjaliDeshmukh/Dataset heart diseases.csv')
df.head()

"""Fetching"""

#Fetching(Dependent)Target column
y=df['target']
y

#Fetch independent column
x=df.drop('target',axis=1)
x

#Size of Dataframe,Target column,Independent column
print(df.shape)
print(y.shape)
print(x.shape)

"""Handling Missing Values"""

#Check for missing values in each column
df.isnull().sum()

"""Statistical Measures of Data"""

df.describe()

#Checking the distribution of target variable
df['target'].value_counts()

"""1 Represent Defective Heart i.e Having Heart Disease

0 Represent Healthy Heart

Splitting the data into Training data and Testing data
"""

X_train,X_test,Y_train,Y_test=train_test_split(x,y,test_size=0.2,stratify=y,random_state=2)

print(x.shape,X_train.shape,X_test.shape)

"""Model Training

Logistic Regression
"""

model=LogisticRegression()

# Training the Logistic Regression model with Training Data
model.fit(X_train,Y_train)

"""Model Evaluation

Accuracy Score
"""

#Accuracy on Training data
X_train_prediction=model.predict(X_train)
training_data_accuracy=accuracy_score(X_train_prediction,Y_train)

print('Accuracy on Training data : ',training_data_accuracy)

#Accuracy on Testing data
X_test_prediction=model.predict(X_test)
testing_data_accuracy=accuracy_score(X_test_prediction,Y_test)

print('Accuracy on Testing data : ',testing_data_accuracy)

"""Building a Predictive system"""

input_data = (70,1,0,130,322,0,0,109,0,2.4,1,3,2)

#Change the input data to a numpy array
input_data_as_numpy_array = np.asarray(input_data)

#reshaped the numpy array as we are predicting for only instance
input_data_reshape = input_data_as_numpy_array.reshape(1, -1)

# Get column names from the original DataFrame (x)
column_names = x.columns

# Create a DataFrame for prediction
input_df = pd.DataFrame(input_data_reshape, columns=column_names)

# Now make the prediction using the DataFrame
prediction = model.predict(input_df)
print(prediction)

if(prediction[0]==0):
  print('The person does not have a Heart Disease')
else:
  print('The person has a Heart Disease')